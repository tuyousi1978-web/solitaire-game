<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ソリティア（Klondike）</title>

<style>
body {
  margin: 0;
  background: linear-gradient(135deg, #1a472a, #0d2818);
  font-family: sans-serif;
  color: #f0e6d2;
  user-select: none;
}

.game {
  max-width: 1200px;
  margin: auto;
  padding: 20px;
}

.top {
  display: flex;
  justify-content: space-between;
  margin-bottom: 30px;
}

.area {
  display: flex;
  gap: 15px;
}

.slot, .pile {
  width: 90px;
  height: 130px;
  border: 2px dashed rgba(255,255,255,0.4);
  border-radius: 8px;
  position: relative;
}

.tableau {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.card {
  width: 90px;
  height: 130px;
  border-radius: 8px;
  position: absolute;
  background: white;
  color: black;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,.5);
}

.card.red {
  color: darkred;
}

button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>

<body>
<div class="game">
  <button onclick="game.newGame()">新しいゲーム</button>

  <div class="top">
    <div class="area">
      <div class="slot" id="stock"></div>
      <div class="slot" id="waste"></div>
    </div>
    <div class="area">
      <div class="slot" id="foundation-0"></div>
      <div class="slot" id="foundation-1"></div>
      <div class="slot" id="foundation-2"></div>
      <div class="slot" id="foundation-3"></div>
    </div>
  </div>

  <div class="tableau">
    <div class="pile" id="pile-0"></div>
    <div class="pile" id="pile-1"></div>
    <div class="pile" id="pile-2"></div>
    <div class="pile" id="pile-3"></div>
    <div class="pile" id="pile-4"></div>
    <div class="pile" id="pile-5"></div>
    <div class="pile" id="pile-6"></div>
  </div>
</div>

<script>
const suits = ["♠","♥","♣","♦"];
const colors = ["black","red","black","red"];

const game = {
  deck: [],
  stock: [],
  waste: [],
  tableau: [[],[],[],[],[],[],[]],
  foundations: [[],[],[],[]],

  newGame() {
    this.createDeck();
    this.deal();
    this.render();
  },

  createDeck() {
    this.deck = [];
    for (let s=0;s<4;s++) {
      for (let v=1;v<=13;v++) {
        this.deck.push({suit:s, value:v});
      }
    }
    this.deck.sort(()=>Math.random()-0.5);
  },

  deal() {
    this.stock = [...this.deck];
    this.waste = [];
    this.tableau = [[],[],[],[],[],[],[]];
    this.foundations = [[],[],[],[]];

    for (let i=0;i<7;i++) {
      for (let j=0;j<=i;j++) {
        const card = this.stock.pop();
        card.faceUp = (j === i);
        this.tableau[i].push(card);
      }
    }
  },

  draw() {
    if (this.stock.length === 0) {
      this.stock = this.waste.reverse();
      this.stock.forEach(c=>c.faceUp=false);
      this.waste = [];
    } else {
      const c = this.stock.pop();
      c.faceUp = true;
      this.waste.push(c);
    }
    this.render();
  },

  render() {
    document.querySelectorAll(".card").forEach(c=>c.remove());

    document.getElementById("stock").onclick = ()=>this.draw();

    this.waste.slice(-1).forEach(card=>{
      this.renderCard(card, document.getElementById("waste"), 0);
    });

    this.tableau.forEach((pile,i)=>{
      pile.forEach((card,j)=>{
        this.renderCard(card, document.getElementById("pile-"+i), j*20);
      });
    });
  },

  renderCard(card, parent, top) {
    if (!card.faceUp) return;

    const d = document.createElement("div");
    d.className = "card " + colors[card.suit];
    d.style.top = top+"px";
    d.textContent = suits[card.suit] + card.value;
    parent.appendChild(d);
  }
};

game.newGame();
</script>
</body>
</html>
